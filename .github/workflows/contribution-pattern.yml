# GitHub Contribution Pattern
# Paste this into .github/workflows/contribution-pattern.yml

name: Draw Contribution Pattern
on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * 0'  # Run weekly on Sunday

jobs:
  create-pattern:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Configure Git
        run: |
          git config user.name "saganaki22"
          git config user.email "info@drbaph.dev"
      
      - name: Create Pattern Commits
        run: |
          python3 << 'PYEOF'
          import json
          import os
          from datetime import datetime, timedelta
          
          # Pattern data (7 rows x 53 columns)
          # 0 = no commit, 1=LIGHTEST (38 commits), 2=light (25 commits), 3=dark (15 commits), 4=DARKEST (1 commit)
          PATTERN = [[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,0,0,0,1,0,1,1,1,1,1,0,1,0,0,1,0,1,1,1,1,1,0,0,1,1,1,0,0],[1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0,0,0,1,0,1,0,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0],[1,1,1,1,1,0,1,1,1,1,1,0,1,0,1,1,1,0,1,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,1,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0],[0,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,0,1,0,0,0,1,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0],[1,1,1,1,1,0,1,0,0,0,1,0,1,1,1,1,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,0,1,1,1,1,1,0,1,1,1,1,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]
          
          # Commit counts for each intensity level
          COMMIT_COUNTS = {0: 0, 1: 38, 2: 25, 3: 15, 4: 1}
          
          # Calculate start date (53 weeks ago from today, on a Sunday)
          today = datetime.now()
          days_since_sunday = (today.weekday() + 1) % 7
          last_sunday = today - timedelta(days=days_since_sunday)
          start_date = last_sunday - timedelta(weeks=52)
          
          commit_count = 0
          for col in range(len(PATTERN[0])):
              for row in range(len(PATTERN)):
                  intensity = PATTERN[row][col]
                  if intensity > 0:
                      commit_date = start_date + timedelta(weeks=col, days=row)
                      num_commits = COMMIT_COUNTS[intensity]
                      
                      # Create commits based on intensity level
                      for i in range(num_commits):
                          date_string = commit_date.strftime('%Y-%m-%d') + f' {12 + i}:00:00'
                          
                          with open('contribution.txt', 'a') as f:
                              f.write(f'Contribution on {date_string}\n')
                          
                          os.system('git add contribution.txt')
                          os.system(f'git commit --date="{date_string}" -m "Pattern commit {commit_count}"')
                          commit_count += 1
          
          if commit_count > 0:
              print(f'Created {commit_count} commits')
          else:
              print('No commits to create. Pattern is empty.')
          PYEOF
      
      - name: Push changes
        run: git push origin main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
